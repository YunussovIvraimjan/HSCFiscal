2019-10-23 21:38:20.482 +06:00 [INF] Starting web host
2019-10-23 21:38:23.395 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 21:38:24.842 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:38:32.191 +06:00 [INF] Executed DbCommand (395ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:38:54.390 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 21:38:54.410 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 21:38:54.497 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:38:54.534 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 21:38:54.554 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:38:55.843 +06:00 [INF] Executed DbCommand (335ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:38:56.027 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:39:09.691 +06:00 [INF] Autorize|Post
2019-10-23 21:39:09.691 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 21:39:10.218 +06:00 [INF] Executed DbCommand (369ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:39:10.793 +06:00 [INF] Executed DbCommand (363ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 21:39:11.174 +06:00 [INF] Executed DbCommand (341ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 21:39:11.531 +06:00 [INF] Executed DbCommand (328ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 21:39:11.927 +06:00 [INF] Executed DbCommand (349ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 21:39:11.954 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 21:39:12.347 +06:00 [INF] Executed DbCommand (362ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 21:39:12.724 +06:00 [INF] Executed DbCommand (357ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:39:13.155 +06:00 [INF] Executed DbCommand (327ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 21:39:13.588 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 17557.538ms.
2019-10-23 21:39:13.601 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:39:13.615 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 19077.4804ms
2019-10-23 21:39:13.616 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:39:13.623 +06:00 [INF] Request finished in 19234.0467ms 200 text/plain; charset=utf-8
2019-10-23 21:39:13.761 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 70
2019-10-23 21:39:13.766 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:39:13.770 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 21:39:13.773 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:39:15.425 +06:00 [INF] Executed DbCommand (315ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:39:15.430 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:39:15.432 +06:00 [INF] Cashbox|Post
2019-10-23 21:39:15.432 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 21:39:15.777 +06:00 [INF] Executed DbCommand (314ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 21:39:16.135 +06:00 [INF] Executed DbCommand (324ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 21:39:16.568 +06:00 [INF] Executed DbCommand (413ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:39:16.943 +06:00 [INF] Executed DbCommand (316ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 21:39:16.978 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1547.0038000000002ms.
2019-10-23 21:39:16.978 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:39:16.979 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 3208.0725ms
2019-10-23 21:39:16.979 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:39:16.979 +06:00 [INF] Request finished in 3217.7406ms 200 text/plain; charset=utf-8
2019-10-23 21:39:17.038 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 105
2019-10-23 21:39:17.038 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:39:17.048 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 21:39:17.048 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:39:18.609 +06:00 [INF] Executed DbCommand (335ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:39:18.612 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:39:18.982 +06:00 [INF] Executed DbCommand (354ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 21:39:19.329 +06:00 [INF] Executed DbCommand (328ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:39:19.813 +06:00 [INF] Executed DbCommand (463ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 21:39:19.829 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:39:20.168 +06:00 [INF] Executed DbCommand (329ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 21:39:20.221 +06:00 [ERR] An exception occurred while iterating over the results of a query for context type 'HSCFiscalRegistrar.ApplicationContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-10-23 21:39:20.222 +06:00 [ERR] An exception occurred while iterating over the results of a query for context type 'HSCFiscalRegistrar.ApplicationContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-10-23 21:39:20.613 +06:00 [INF] Executed DbCommand (326ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 21:39:21.053 +06:00 [INF] Executed DbCommand (327ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Decimal), @p5='?', @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime), @p8='?' (DbType = Decimal), @p9='?' (DbType = Decimal), @p10='?' (DbType = Decimal), @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Shifts" ("Id", "BuySaldoBegin", "BuySaldoEnd", "CloseDate", "KkmBalance", "KkmId", "Number", "OpenDate", "RetunBuySaldoBegin", "RetunBuySaldoEnd", "RetunSellSaldoBegin", "RetunSellSaldoEnd", "SellSaldoBegin", "SellSaldoEnd", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2019-10-23 21:39:21.368 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 21:39:21.375 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:39:21.713 +06:00 [INF] Executed DbCommand (334ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 21:39:22.082 +06:00 [INF] Executed DbCommand (318ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:22.504 +06:00 [INF] Executed DbCommand (412ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:22.843 +06:00 [INF] Executed DbCommand (314ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:23.164 +06:00 [INF] Executed DbCommand (312ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:23.465 +06:00 [INF] Executed DbCommand (295ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:23.806 +06:00 [INF] Executed DbCommand (339ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:24.113 +06:00 [INF] Executed DbCommand (306ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:24.763 +06:00 [INF] Executed DbCommand (649ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:25.072 +06:00 [INF] Executed DbCommand (309ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:25.391 +06:00 [INF] Executed DbCommand (317ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:25.917 +06:00 [INF] Executed DbCommand (525ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:26.968 +06:00 [INF] Executed DbCommand (1,050ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:27.954 +06:00 [INF] Executed DbCommand (985ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:28.907 +06:00 [INF] Executed DbCommand (953ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:29.563 +06:00 [INF] Executed DbCommand (655ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:29.897 +06:00 [INF] Executed DbCommand (333ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:30.298 +06:00 [INF] Executed DbCommand (400ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:30.673 +06:00 [INF] Executed DbCommand (374ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:31.009 +06:00 [INF] Executed DbCommand (335ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:31.853 +06:00 [INF] Executed DbCommand (843ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:39:32.353 +06:00 [INF] Executed DbCommand (491ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:39:32.976 +06:00 [INF] Executed DbCommand (617ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:39:33.972 +06:00 [INF] Executed DbCommand (989ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:39:34.963 +06:00 [INF] Executed DbCommand (990ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:39:35.642 +06:00 [INF] Executed DbCommand (676ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:39:35.964 +06:00 [INF] Executed DbCommand (315ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 21:39:36.572 +06:00 [INF] Executed DbCommand (607ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:39:36.945 +06:00 [INF] Executed DbCommand (373ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:39:37.323 +06:00 [INF] Executed DbCommand (359ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 21:39:37.946 +06:00 [INF] Executed DbCommand (566ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 21:39:38.761 +06:00 [INF] OfdXReport|Post
2019-10-23 21:39:38.761 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 21:39:38.983 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 20371.456400000003ms.
2019-10-23 21:39:38.983 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:39:38.983 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 21935.6037ms
2019-10-23 21:39:38.984 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:39:38.984 +06:00 [INF] Request finished in 21946.1516ms 200 text/plain; charset=utf-8
2019-10-23 21:39:40.543 +06:00 [ERR] Call failed. An error occurred while sending the request. POST http://52.38.152.232:8082
2019-10-23 21:41:44.661 +06:00 [INF] Starting web host
2019-10-23 21:41:46.586 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 21:41:48.127 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:41:53.316 +06:00 [INF] Executed DbCommand (435ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:44:17.408 +06:00 [INF] Starting web host
2019-10-23 21:44:19.373 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 21:44:20.828 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:44:25.875 +06:00 [INF] Executed DbCommand (445ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:44:35.575 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 21:44:35.593 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 21:44:35.640 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:44:35.670 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 21:44:35.681 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:44:37.470 +06:00 [INF] Executed DbCommand (543ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:44:37.664 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:44:37.668 +06:00 [INF] Autorize|Post
2019-10-23 21:44:37.668 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 21:44:38.221 +06:00 [INF] Executed DbCommand (425ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:44:38.847 +06:00 [INF] Executed DbCommand (415ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 21:44:39.328 +06:00 [INF] Executed DbCommand (432ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 21:44:39.768 +06:00 [INF] Executed DbCommand (413ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 21:44:40.221 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 21:44:40.251 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 21:44:40.685 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 21:44:41.117 +06:00 [INF] Executed DbCommand (412ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:44:41.659 +06:00 [INF] Executed DbCommand (443ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 21:44:42.188 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4521.1822ms.
2019-10-23 21:44:42.205 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:44:42.219 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 6545.4507ms
2019-10-23 21:44:42.220 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:44:42.227 +06:00 [INF] Request finished in 6653.4086ms 200 text/plain; charset=utf-8
2019-10-23 21:44:42.365 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 70
2019-10-23 21:44:42.368 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:44:42.371 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 21:44:42.373 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:44:43.981 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:44:43.987 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:44:43.988 +06:00 [INF] Cashbox|Post
2019-10-23 21:44:43.988 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 21:44:44.435 +06:00 [INF] Executed DbCommand (417ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 21:44:44.896 +06:00 [INF] Executed DbCommand (423ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 21:44:45.307 +06:00 [INF] Executed DbCommand (390ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:44:45.746 +06:00 [INF] Executed DbCommand (393ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 21:44:45.753 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 21:44:45.763 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:44:46.159 +06:00 [INF] Executed DbCommand (389ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 21:44:46.233 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2246.1048ms.
2019-10-23 21:44:46.233 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:44:46.234 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 3862.2898ms
2019-10-23 21:44:46.234 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:44:46.234 +06:00 [INF] Request finished in 3868.7988ms 200 text/plain; charset=utf-8
2019-10-23 21:44:46.351 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 105
2019-10-23 21:44:46.351 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:44:46.358 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 21:44:46.358 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:44:47.956 +06:00 [INF] Executed DbCommand (419ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:44:47.961 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:44:48.390 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 21:44:48.788 +06:00 [INF] Executed DbCommand (387ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:44:49.185 +06:00 [INF] Executed DbCommand (377ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 21:44:49.196 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:44:49.583 +06:00 [INF] Executed DbCommand (382ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 21:44:49.995 +06:00 [INF] Executed DbCommand (383ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:50.396 +06:00 [INF] Executed DbCommand (392ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:50.797 +06:00 [INF] Executed DbCommand (386ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:51.186 +06:00 [INF] Executed DbCommand (381ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:51.567 +06:00 [INF] Executed DbCommand (371ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:51.954 +06:00 [INF] Executed DbCommand (385ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:52.337 +06:00 [INF] Executed DbCommand (382ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:52.756 +06:00 [INF] Executed DbCommand (418ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:53.144 +06:00 [INF] Executed DbCommand (388ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:53.544 +06:00 [INF] Executed DbCommand (399ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:53.938 +06:00 [INF] Executed DbCommand (393ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:54.328 +06:00 [INF] Executed DbCommand (389ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:54.725 +06:00 [INF] Executed DbCommand (396ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:55.110 +06:00 [INF] Executed DbCommand (384ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:55.522 +06:00 [INF] Executed DbCommand (411ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:55.900 +06:00 [INF] Executed DbCommand (377ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:56.340 +06:00 [INF] Executed DbCommand (440ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:56.740 +06:00 [INF] Executed DbCommand (399ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:57.146 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:57.567 +06:00 [INF] Executed DbCommand (420ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:44:57.956 +06:00 [INF] Executed DbCommand (380ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:44:58.371 +06:00 [INF] Executed DbCommand (408ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:44:58.786 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:44:59.208 +06:00 [INF] Executed DbCommand (421ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:44:59.598 +06:00 [INF] Executed DbCommand (386ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:44:59.986 +06:00 [INF] Executed DbCommand (382ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 21:45:00.397 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:45:00.776 +06:00 [INF] Executed DbCommand (379ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:46:17.213 +06:00 [INF] Executed DbCommand (464ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 21:47:21.269 +06:00 [INF] Executed DbCommand (457ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 21:48:29.107 +06:00 [INF] OfdXReport|Post
2019-10-23 21:48:29.995 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 21:48:34.854 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 226893.08560000002ms.
2019-10-23 21:48:34.854 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:48:34.855 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 228496.69220000002ms
2019-10-23 21:48:34.855 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:48:34.855 +06:00 [INF] Request finished in 228503.8184ms 200 text/plain; charset=utf-8
2019-10-23 21:51:41.496 +06:00 [INF] Starting web host
2019-10-23 21:51:43.973 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 21:51:45.457 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:51:49.787 +06:00 [INF] Executed DbCommand (419ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:51:54.437 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 21:51:54.451 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 21:51:54.501 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:51:54.536 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 21:51:54.545 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:51:56.861 +06:00 [INF] Executed DbCommand (412ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:51:57.039 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:51:57.042 +06:00 [INF] Autorize|Post
2019-10-23 21:51:57.043 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 21:51:57.689 +06:00 [INF] Executed DbCommand (487ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:51:58.342 +06:00 [INF] Executed DbCommand (396ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 21:51:58.797 +06:00 [INF] Executed DbCommand (397ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 21:51:59.228 +06:00 [INF] Executed DbCommand (404ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 21:52:00.148 +06:00 [INF] Executed DbCommand (888ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 21:52:00.165 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 21:52:02.202 +06:00 [INF] Executed DbCommand (2,018ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 21:52:02.630 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:52:03.187 +06:00 [INF] Executed DbCommand (440ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 21:52:03.650 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 6607.5923ms.
2019-10-23 21:52:03.663 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:52:03.679 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 9139.5007ms
2019-10-23 21:52:03.681 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:52:03.690 +06:00 [INF] Request finished in 9253.4907ms 200 text/plain; charset=utf-8
2019-10-23 21:52:03.808 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 71
2019-10-23 21:52:03.811 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:52:03.813 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 21:52:03.814 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:52:06.228 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:52:06.232 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:52:06.236 +06:00 [INF] Cashbox|Post
2019-10-23 21:52:06.236 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 21:52:06.671 +06:00 [INF] Executed DbCommand (414ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 21:52:07.079 +06:00 [INF] Executed DbCommand (380ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 21:52:07.498 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:52:07.938 +06:00 [INF] Executed DbCommand (388ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 21:52:07.944 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 21:52:07.954 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:52:08.341 +06:00 [INF] Executed DbCommand (380ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 21:52:08.413 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2180.3885ms.
2019-10-23 21:52:08.413 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:52:08.414 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 4600.7124ms
2019-10-23 21:52:08.414 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:52:08.414 +06:00 [INF] Request finished in 4605.9514ms 200 text/plain; charset=utf-8
2019-10-23 21:52:08.516 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 106
2019-10-23 21:52:08.516 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:52:08.521 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 21:52:08.522 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:52:11.100 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:52:11.103 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:52:11.502 +06:00 [INF] Executed DbCommand (381ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 21:52:11.909 +06:00 [INF] Executed DbCommand (392ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:52:12.323 +06:00 [INF] Executed DbCommand (394ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 21:52:12.335 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:52:12.746 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 21:52:14.168 +06:00 [INF] Executed DbCommand (1,383ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:14.578 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:15.012 +06:00 [INF] Executed DbCommand (411ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:15.418 +06:00 [INF] Executed DbCommand (399ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:15.811 +06:00 [INF] Executed DbCommand (385ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:16.218 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:16.610 +06:00 [INF] Executed DbCommand (391ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:17.036 +06:00 [INF] Executed DbCommand (425ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:17.424 +06:00 [INF] Executed DbCommand (388ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:17.820 +06:00 [INF] Executed DbCommand (395ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:18.218 +06:00 [INF] Executed DbCommand (397ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:18.619 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:19.031 +06:00 [INF] Executed DbCommand (411ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:19.958 +06:00 [INF] Executed DbCommand (926ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:20.339 +06:00 [INF] Executed DbCommand (380ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:20.742 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:21.131 +06:00 [INF] Executed DbCommand (388ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:21.518 +06:00 [INF] Executed DbCommand (387ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:21.900 +06:00 [INF] Executed DbCommand (381ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:22.308 +06:00 [INF] Executed DbCommand (407ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:52:22.721 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:52:24.159 +06:00 [INF] Executed DbCommand (1,432ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:52:24.549 +06:00 [INF] Executed DbCommand (385ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:52:24.939 +06:00 [INF] Executed DbCommand (389ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:52:25.372 +06:00 [INF] Executed DbCommand (429ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:52:25.749 +06:00 [INF] Executed DbCommand (373ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 21:52:26.129 +06:00 [INF] Executed DbCommand (379ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:52:26.548 +06:00 [INF] Executed DbCommand (418ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:52:31.688 +06:00 [INF] Executed DbCommand (398ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 21:52:38.751 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 21:53:12.405 +06:00 [INF] OfdXReport|Post
2019-10-23 21:53:13.159 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 21:56:08.955 +06:00 [INF] Starting web host
2019-10-23 21:56:11.702 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 21:56:13.236 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:56:17.683 +06:00 [INF] Executed DbCommand (465ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:56:21.060 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 21:56:21.079 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 21:56:21.141 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:56:21.169 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 21:56:21.180 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:56:22.447 +06:00 [INF] Executed DbCommand (400ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:56:22.651 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:56:22.654 +06:00 [INF] Autorize|Post
2019-10-23 21:56:22.654 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 21:56:23.273 +06:00 [INF] Executed DbCommand (452ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:56:24.043 +06:00 [INF] Executed DbCommand (422ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 21:56:24.992 +06:00 [INF] Executed DbCommand (894ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 21:56:25.436 +06:00 [INF] Executed DbCommand (422ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 21:56:26.424 +06:00 [INF] Executed DbCommand (944ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 21:56:26.447 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 21:56:26.850 +06:00 [INF] Executed DbCommand (382ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 21:56:27.261 +06:00 [INF] Executed DbCommand (387ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:56:27.782 +06:00 [INF] Executed DbCommand (399ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 21:56:28.303 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 5649.7541ms.
2019-10-23 21:56:28.316 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:56:28.331 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 7158.0994ms
2019-10-23 21:56:28.332 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:56:28.340 +06:00 [INF] Request finished in 7281.5443ms 200 text/plain; charset=utf-8
2019-10-23 21:56:28.408 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 69
2019-10-23 21:56:28.412 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:56:28.416 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 21:56:28.418 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:56:29.976 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:56:29.980 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:56:29.981 +06:00 [INF] Cashbox|Post
2019-10-23 21:56:29.981 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 21:56:30.395 +06:00 [INF] Executed DbCommand (392ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 21:56:30.815 +06:00 [INF] Executed DbCommand (383ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 21:56:32.286 +06:00 [INF] Executed DbCommand (1,448ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:56:32.760 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 21:56:32.766 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 21:56:32.777 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:56:33.202 +06:00 [INF] Executed DbCommand (418ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 21:56:33.271 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3290.6172ms.
2019-10-23 21:56:33.271 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:56:33.271 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 4855.246ms
2019-10-23 21:56:33.271 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:56:33.272 +06:00 [INF] Request finished in 4863.6346ms 200 text/plain; charset=utf-8
2019-10-23 21:56:33.448 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 104
2019-10-23 21:56:33.448 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:56:33.456 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 21:56:33.456 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:56:35.063 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:56:35.069 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:56:36.623 +06:00 [INF] Executed DbCommand (1,521ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 21:56:38.005 +06:00 [INF] Executed DbCommand (1,370ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:56:38.436 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 21:56:38.447 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:56:38.844 +06:00 [INF] Executed DbCommand (392ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 21:56:40.315 +06:00 [INF] Executed DbCommand (1,426ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:40.723 +06:00 [INF] Executed DbCommand (398ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:42.183 +06:00 [INF] Executed DbCommand (1,436ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:42.611 +06:00 [INF] Executed DbCommand (420ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:43.014 +06:00 [INF] Executed DbCommand (396ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:43.434 +06:00 [INF] Executed DbCommand (418ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:43.835 +06:00 [INF] Executed DbCommand (400ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:44.761 +06:00 [INF] Executed DbCommand (925ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:45.212 +06:00 [INF] Executed DbCommand (450ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:46.641 +06:00 [INF] Executed DbCommand (1,428ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:47.086 +06:00 [INF] Executed DbCommand (445ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:47.972 +06:00 [INF] Executed DbCommand (886ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:48.413 +06:00 [INF] Executed DbCommand (440ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:48.815 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:49.224 +06:00 [INF] Executed DbCommand (408ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:50.705 +06:00 [INF] Executed DbCommand (1,480ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:51.126 +06:00 [INF] Executed DbCommand (421ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:51.558 +06:00 [INF] Executed DbCommand (431ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:51.961 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:52.397 +06:00 [INF] Executed DbCommand (435ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:56:52.801 +06:00 [INF] Executed DbCommand (395ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:56:53.233 +06:00 [INF] Executed DbCommand (425ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:56:53.637 +06:00 [INF] Executed DbCommand (399ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:56:55.090 +06:00 [INF] Executed DbCommand (1,452ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:56:56.556 +06:00 [INF] Executed DbCommand (1,461ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 21:56:56.964 +06:00 [INF] Executed DbCommand (403ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 21:56:57.404 +06:00 [INF] Executed DbCommand (439ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 21:56:57.833 +06:00 [INF] Executed DbCommand (428ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 21:57:14.713 +06:00 [INF] Executed DbCommand (434ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 21:57:28.372 +06:00 [INF] Executed DbCommand (872ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 21:58:22.657 +06:00 [INF] OfdXReport|Post
2019-10-23 21:58:23.403 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 21:58:46.491 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 131422.30120000002ms.
2019-10-23 21:58:46.491 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:58:46.492 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 133035.8329ms
2019-10-23 21:58:46.492 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:58:46.492 +06:00 [INF] Request finished in 133043.5293ms 200 text/plain; charset=utf-8
2019-10-23 21:59:19.247 +06:00 [INF] Starting web host
2019-10-23 21:59:20.979 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 21:59:22.430 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:59:28.889 +06:00 [INF] Executed DbCommand (422ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:59:29.741 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 21:59:29.754 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 21:59:29.811 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:59:29.838 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 21:59:29.850 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:59:34.280 +06:00 [INF] Executed DbCommand (3,227ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:59:34.481 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:59:34.484 +06:00 [INF] Autorize|Post
2019-10-23 21:59:34.484 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 21:59:35.501 +06:00 [INF] Executed DbCommand (877ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:59:36.116 +06:00 [INF] Executed DbCommand (382ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 21:59:36.566 +06:00 [INF] Executed DbCommand (391ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 21:59:36.990 +06:00 [INF] Executed DbCommand (391ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 21:59:37.450 +06:00 [INF] Executed DbCommand (419ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 21:59:37.480 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 21:59:37.919 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 21:59:38.355 +06:00 [INF] Executed DbCommand (417ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 21:59:38.920 +06:00 [INF] Executed DbCommand (443ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 21:59:39.421 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4937.0951000000005ms.
2019-10-23 21:59:39.434 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:59:39.449 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 9607.1747ms
2019-10-23 21:59:39.451 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 21:59:39.459 +06:00 [INF] Request finished in 9717.592ms 200 text/plain; charset=utf-8
2019-10-23 21:59:39.588 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 71
2019-10-23 21:59:39.593 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:59:39.597 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 21:59:39.599 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:59:41.674 +06:00 [INF] Executed DbCommand (872ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:59:41.682 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:59:41.684 +06:00 [INF] Cashbox|Post
2019-10-23 21:59:41.684 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 21:59:42.186 +06:00 [INF] Executed DbCommand (469ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 21:59:42.625 +06:00 [INF] Executed DbCommand (412ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 21:59:43.060 +06:00 [INF] Executed DbCommand (420ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:59:43.559 +06:00 [INF] Executed DbCommand (427ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 21:59:43.567 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 21:59:43.580 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:59:43.978 +06:00 [INF] Executed DbCommand (388ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 21:59:44.047 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2364.6346000000003ms.
2019-10-23 21:59:44.047 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 21:59:44.047 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 4450.6752000000006ms
2019-10-23 21:59:44.048 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 21:59:44.048 +06:00 [INF] Request finished in 4459.4387ms 200 text/plain; charset=utf-8
2019-10-23 21:59:44.201 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 106
2019-10-23 21:59:44.201 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 21:59:44.209 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 21:59:44.209 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 21:59:46.242 +06:00 [INF] Executed DbCommand (877ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 21:59:46.245 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 21:59:47.531 +06:00 [INF] Executed DbCommand (1,271ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 21:59:47.946 +06:00 [INF] Executed DbCommand (400ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 21:59:48.394 +06:00 [INF] Executed DbCommand (428ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 21:59:48.407 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 21:59:48.845 +06:00 [INF] Executed DbCommand (431ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 21:59:49.278 +06:00 [INF] Executed DbCommand (393ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:49.678 +06:00 [INF] Executed DbCommand (391ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:50.101 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:50.479 +06:00 [INF] Executed DbCommand (369ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:50.872 +06:00 [INF] Executed DbCommand (388ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:51.288 +06:00 [INF] Executed DbCommand (413ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:52.199 +06:00 [INF] Executed DbCommand (911ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:52.602 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:53.052 +06:00 [INF] Executed DbCommand (450ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:53.442 +06:00 [INF] Executed DbCommand (389ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:53.859 +06:00 [INF] Executed DbCommand (416ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:54.269 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:54.645 +06:00 [INF] Executed DbCommand (375ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:55.495 +06:00 [INF] Executed DbCommand (849ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:56.359 +06:00 [INF] Executed DbCommand (863ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:56.778 +06:00 [INF] Executed DbCommand (418ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:57.159 +06:00 [INF] Executed DbCommand (381ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:58.605 +06:00 [INF] Executed DbCommand (1,445ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:59.013 +06:00 [INF] Executed DbCommand (408ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:59.429 +06:00 [INF] Executed DbCommand (415ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 21:59:59.840 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:00:00.260 +06:00 [INF] Executed DbCommand (413ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:00:00.785 +06:00 [INF] Executed DbCommand (518ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:00:01.197 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:00:01.562 +06:00 [INF] Executed DbCommand (363ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:00:01.990 +06:00 [INF] Executed DbCommand (423ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 22:00:02.349 +06:00 [INF] Executed DbCommand (358ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:00:04.399 +06:00 [INF] Executed DbCommand (2,049ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:00:04.804 +06:00 [INF] Executed DbCommand (388ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 22:00:05.748 +06:00 [INF] Executed DbCommand (829ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 22:00:06.703 +06:00 [INF] OfdXReport|Post
2019-10-23 22:00:06.703 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 22:00:06.937 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 20691.9841ms.
2019-10-23 22:00:06.937 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:00:06.937 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 22728.241ms
2019-10-23 22:00:06.937 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:00:06.937 +06:00 [INF] Request finished in 22736.5144ms 200 text/plain; charset=utf-8
2019-10-23 22:00:48.463 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 22:00:48.463 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:00:48.464 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 22:00:48.464 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:00:50.157 +06:00 [INF] Executed DbCommand (429ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:00:50.164 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:00:50.164 +06:00 [INF] Autorize|Post
2019-10-23 22:00:50.164 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 22:00:51.649 +06:00 [INF] Executed DbCommand (1,484ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:00:52.084 +06:00 [INF] Executed DbCommand (430ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 22:00:52.529 +06:00 [INF] Executed DbCommand (444ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 22:00:52.939 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 22:00:53.356 +06:00 [INF] Executed DbCommand (416ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 22:00:53.357 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 22:00:53.839 +06:00 [INF] Executed DbCommand (481ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 22:00:55.859 +06:00 [INF] Executed DbCommand (2,018ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:00:56.702 +06:00 [INF] Executed DbCommand (842ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 22:00:57.077 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 6912.4985000000006ms.
2019-10-23 22:00:57.077 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:00:57.078 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 8613.6921ms
2019-10-23 22:00:57.078 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:00:57.079 +06:00 [INF] Request finished in 8615.4401ms 200 text/plain; charset=utf-8
2019-10-23 22:00:57.215 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 71
2019-10-23 22:00:57.216 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:00:57.216 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 22:00:57.216 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:00:59.333 +06:00 [INF] Executed DbCommand (896ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:00:59.334 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:00:59.334 +06:00 [INF] Cashbox|Post
2019-10-23 22:00:59.334 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 22:01:00.099 +06:00 [INF] Executed DbCommand (763ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 22:01:00.862 +06:00 [INF] Executed DbCommand (762ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 22:01:01.242 +06:00 [INF] Executed DbCommand (379ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:01:01.648 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 22:01:02.537 +06:00 [INF] Executed DbCommand (888ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 22:01:02.538 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3203.7829ms.
2019-10-23 22:01:02.538 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:01:02.538 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 5321.9981000000007ms
2019-10-23 22:01:02.538 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:01:02.538 +06:00 [INF] Request finished in 5322.6257ms 200 text/plain; charset=utf-8
2019-10-23 22:01:02.563 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 106
2019-10-23 22:01:02.563 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:01:02.563 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 22:01:02.564 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:01:04.095 +06:00 [INF] Executed DbCommand (386ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:01:04.096 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:01:06.628 +06:00 [INF] Executed DbCommand (2,531ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 22:01:07.578 +06:00 [INF] Executed DbCommand (949ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:01:09.385 +06:00 [INF] Executed DbCommand (1,806ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 22:01:09.761 +06:00 [INF] Executed DbCommand (375ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 22:01:10.179 +06:00 [INF] Executed DbCommand (417ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:11.635 +06:00 [INF] Executed DbCommand (1,456ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:12.076 +06:00 [INF] Executed DbCommand (440ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:12.493 +06:00 [INF] Executed DbCommand (416ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:13.457 +06:00 [INF] Executed DbCommand (964ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:13.883 +06:00 [INF] Executed DbCommand (424ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:14.428 +06:00 [INF] Executed DbCommand (545ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:15.896 +06:00 [INF] Executed DbCommand (1,468ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:16.337 +06:00 [INF] Executed DbCommand (440ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:16.766 +06:00 [INF] Executed DbCommand (428ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:17.418 +06:00 [INF] Executed DbCommand (651ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:17.940 +06:00 [INF] Executed DbCommand (522ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:18.619 +06:00 [INF] Executed DbCommand (678ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:20.091 +06:00 [INF] Executed DbCommand (1,470ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:20.511 +06:00 [INF] Executed DbCommand (419ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:21.967 +06:00 [INF] Executed DbCommand (1,456ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:22.508 +06:00 [INF] Executed DbCommand (540ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:22.941 +06:00 [INF] Executed DbCommand (432ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:23.506 +06:00 [INF] Executed DbCommand (564ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:23.942 +06:00 [INF] Executed DbCommand (436ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:01:24.369 +06:00 [INF] Executed DbCommand (427ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:01:24.962 +06:00 [INF] Executed DbCommand (592ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:01:25.626 +06:00 [INF] Executed DbCommand (664ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:01:26.038 +06:00 [INF] Executed DbCommand (411ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:01:26.469 +06:00 [INF] Executed DbCommand (430ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:01:27.410 +06:00 [INF] Executed DbCommand (941ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 22:01:28.400 +06:00 [INF] Executed DbCommand (988ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:01:28.805 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:01:29.218 +06:00 [INF] Executed DbCommand (412ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 22:01:31.670 +06:00 [INF] Executed DbCommand (2,450ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 22:01:32.061 +06:00 [INF] OfdXReport|Post
2019-10-23 22:01:32.061 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 22:02:01.414 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 57313.0791ms.
2019-10-23 22:02:01.419 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:02:01.419 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 58855.7376ms
2019-10-23 22:02:01.419 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:02:01.419 +06:00 [INF] Request finished in 58856.6098ms 200 text/plain; charset=utf-8
2019-10-23 22:07:03.678 +06:00 [INF] Starting web host
2019-10-23 22:07:06.283 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 22:07:07.712 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:07:16.981 +06:00 [INF] Executed DbCommand (537ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:07:22.845 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 22:07:22.858 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 22:07:22.906 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:07:22.936 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 22:07:22.944 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:07:25.894 +06:00 [INF] Executed DbCommand (477ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:07:26.075 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:07:26.078 +06:00 [INF] Autorize|Post
2019-10-23 22:07:26.078 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 22:07:26.942 +06:00 [INF] Executed DbCommand (707ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:07:27.629 +06:00 [INF] Executed DbCommand (458ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 22:07:28.113 +06:00 [INF] Executed DbCommand (425ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 22:07:29.079 +06:00 [INF] Executed DbCommand (950ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 22:07:29.561 +06:00 [INF] Executed DbCommand (425ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 22:07:29.593 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 22:07:30.606 +06:00 [INF] Executed DbCommand (993ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 22:07:32.963 +06:00 [INF] Executed DbCommand (2,331ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:07:33.972 +06:00 [INF] Executed DbCommand (893ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 22:07:34.504 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 8426.460500000001ms.
2019-10-23 22:07:34.516 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:07:34.530 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 11590.383ms
2019-10-23 22:07:34.531 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:07:34.538 +06:00 [INF] Request finished in 11694.0843ms 200 text/plain; charset=utf-8
2019-10-23 22:07:34.611 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 68
2019-10-23 22:07:34.614 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:07:34.617 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 22:07:34.618 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:07:37.454 +06:00 [INF] Executed DbCommand (1,645ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:07:37.459 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:07:37.460 +06:00 [INF] Cashbox|Post
2019-10-23 22:07:37.460 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 22:07:37.889 +06:00 [INF] Executed DbCommand (399ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 22:07:40.192 +06:00 [INF] Executed DbCommand (2,272ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 22:07:40.640 +06:00 [INF] Executed DbCommand (427ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:07:41.145 +06:00 [INF] Executed DbCommand (441ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 22:07:41.150 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 22:07:41.159 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 22:07:42.401 +06:00 [INF] Executed DbCommand (1,236ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 22:07:42.453 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4993.4119ms.
2019-10-23 22:07:42.453 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:07:42.453 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 7836.125ms
2019-10-23 22:07:42.453 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:07:42.454 +06:00 [INF] Request finished in 7843.0198ms 200 text/plain; charset=utf-8
2019-10-23 22:07:42.609 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 103
2019-10-23 22:07:42.609 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:07:42.615 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 22:07:42.615 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:07:47.641 +06:00 [INF] Executed DbCommand (420ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:07:47.646 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:07:48.562 +06:00 [INF] Executed DbCommand (889ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 22:07:49.421 +06:00 [INF] Executed DbCommand (840ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:07:51.079 +06:00 [INF] Executed DbCommand (1,632ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 22:07:51.092 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 22:07:58.934 +06:00 [INF] Executed DbCommand (7,838ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 22:08:02.469 +06:00 [INF] Executed DbCommand (3,488ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:02.919 +06:00 [INF] Executed DbCommand (444ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:03.346 +06:00 [INF] Executed DbCommand (412ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:03.756 +06:00 [INF] Executed DbCommand (397ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:05.348 +06:00 [INF] Executed DbCommand (1,586ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:05.796 +06:00 [INF] Executed DbCommand (445ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:06.450 +06:00 [INF] Executed DbCommand (653ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:06.845 +06:00 [INF] Executed DbCommand (394ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:07.312 +06:00 [INF] Executed DbCommand (466ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:07.754 +06:00 [INF] Executed DbCommand (442ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:08.208 +06:00 [INF] Executed DbCommand (453ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:08.639 +06:00 [INF] Executed DbCommand (431ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:09.111 +06:00 [INF] Executed DbCommand (471ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:09.545 +06:00 [INF] Executed DbCommand (434ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:11.285 +06:00 [INF] Executed DbCommand (1,739ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:11.766 +06:00 [INF] Executed DbCommand (480ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:12.498 +06:00 [INF] Executed DbCommand (732ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:12.960 +06:00 [INF] Executed DbCommand (461ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:13.389 +06:00 [INF] Executed DbCommand (428ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:13.805 +06:00 [INF] Executed DbCommand (415ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:08:14.219 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:08:14.631 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:08:15.050 +06:00 [INF] Executed DbCommand (413ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:08:15.461 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:08:15.873 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:08:16.310 +06:00 [INF] Executed DbCommand (431ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 22:08:16.948 +06:00 [INF] Executed DbCommand (638ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:08:18.068 +06:00 [INF] Executed DbCommand (1,119ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:08:18.946 +06:00 [INF] Executed DbCommand (862ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 22:08:21.943 +06:00 [INF] Executed DbCommand (2,893ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 22:08:23.440 +06:00 [INF] OfdXReport|Post
2019-10-23 22:08:23.440 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 22:08:23.672 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 36025.821ms.
2019-10-23 22:08:23.672 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:08:23.672 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 41057.3003ms
2019-10-23 22:08:23.672 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:08:23.672 +06:00 [INF] Request finished in 41063.1916ms 200 text/plain; charset=utf-8
2019-10-23 22:13:37.642 +06:00 [INF] Starting web host
2019-10-23 22:13:40.269 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 22:13:41.707 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:13:53.279 +06:00 [INF] Executed DbCommand (427ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:14:41.553 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 22:14:41.566 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 22:14:41.618 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:14:41.646 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 22:14:41.655 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:14:43.281 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:14:43.479 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:14:43.483 +06:00 [INF] Autorize|Post
2019-10-23 22:14:43.483 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 22:14:44.126 +06:00 [INF] Executed DbCommand (495ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:14:44.777 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 22:14:45.226 +06:00 [INF] Executed DbCommand (395ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 22:14:45.665 +06:00 [INF] Executed DbCommand (425ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 22:14:46.138 +06:00 [INF] Executed DbCommand (431ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 22:14:46.170 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 22:14:46.604 +06:00 [INF] Executed DbCommand (412ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 22:14:47.566 +06:00 [INF] Executed DbCommand (935ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:14:48.553 +06:00 [INF] Executed DbCommand (869ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 22:14:49.064 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 5581.4482ms.
2019-10-23 22:14:49.077 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:14:49.095 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 7445.1628ms
2019-10-23 22:14:49.097 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:14:49.105 +06:00 [INF] Request finished in 7552.6588ms 200 text/plain; charset=utf-8
2019-10-23 22:14:49.647 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 70
2019-10-23 22:14:49.651 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:14:49.654 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 22:14:49.663 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:14:51.293 +06:00 [INF] Executed DbCommand (395ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:14:51.297 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:14:51.298 +06:00 [INF] Cashbox|Post
2019-10-23 22:14:51.298 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 22:14:52.742 +06:00 [INF] Executed DbCommand (1,410ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 22:14:53.157 +06:00 [INF] Executed DbCommand (376ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 22:14:53.642 +06:00 [INF] Executed DbCommand (469ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:14:54.090 +06:00 [INF] Executed DbCommand (398ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 22:14:54.094 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 22:14:54.100 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 22:14:54.526 +06:00 [INF] Executed DbCommand (422ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 22:14:54.596 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3298.3854ms.
2019-10-23 22:14:54.596 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:14:54.596 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 4942.0554ms
2019-10-23 22:14:54.597 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:14:54.597 +06:00 [INF] Request finished in 4949.6191ms 200 text/plain; charset=utf-8
2019-10-23 22:14:54.745 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 105
2019-10-23 22:14:54.746 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:14:54.752 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 22:14:54.753 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:14:56.413 +06:00 [INF] Executed DbCommand (428ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:14:56.417 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:14:56.868 +06:00 [INF] Executed DbCommand (425ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 22:14:57.334 +06:00 [INF] Executed DbCommand (451ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:14:57.784 +06:00 [INF] Executed DbCommand (424ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 22:14:57.797 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 22:14:58.203 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 22:15:00.892 +06:00 [INF] Executed DbCommand (2,651ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:01.342 +06:00 [INF] Executed DbCommand (440ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:01.777 +06:00 [INF] Executed DbCommand (414ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:02.173 +06:00 [INF] Executed DbCommand (391ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:03.626 +06:00 [INF] Executed DbCommand (1,445ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:04.064 +06:00 [INF] Executed DbCommand (430ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:04.535 +06:00 [INF] Executed DbCommand (470ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:04.930 +06:00 [INF] Executed DbCommand (394ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:05.333 +06:00 [INF] Executed DbCommand (402ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:05.744 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:06.152 +06:00 [INF] Executed DbCommand (408ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:06.570 +06:00 [INF] Executed DbCommand (418ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:08.016 +06:00 [INF] Executed DbCommand (1,445ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:08.422 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:08.832 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:09.234 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:09.662 +06:00 [INF] Executed DbCommand (427ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:10.083 +06:00 [INF] Executed DbCommand (420ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:10.473 +06:00 [INF] Executed DbCommand (389ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:10.903 +06:00 [INF] Executed DbCommand (430ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:15:11.320 +06:00 [INF] Executed DbCommand (408ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:15:11.733 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:15:12.161 +06:00 [INF] Executed DbCommand (423ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:15:12.576 +06:00 [INF] Executed DbCommand (414ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:15:12.983 +06:00 [INF] Executed DbCommand (403ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:15:13.393 +06:00 [INF] Executed DbCommand (404ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 22:15:13.823 +06:00 [INF] Executed DbCommand (429ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:15:14.263 +06:00 [INF] Executed DbCommand (440ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:15:14.683 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 22:15:15.273 +06:00 [INF] Executed DbCommand (466ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 22:15:15.640 +06:00 [INF] OfdXReport|Post
2019-10-23 22:15:15.640 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 22:15:15.866 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 19448.3252ms.
2019-10-23 22:15:15.866 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:15:15.866 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 21113.425300000003ms
2019-10-23 22:15:15.866 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:15:15.866 +06:00 [INF] Request finished in 21120.7766ms 200 text/plain; charset=utf-8
2019-10-23 22:27:34.827 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 22:27:34.828 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:27:34.828 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 22:27:34.829 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:27:39.228 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:27:39.234 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:27:39.235 +06:00 [INF] Autorize|Post
2019-10-23 22:27:39.235 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:dhdhdhd
2019-10-23 22:27:39.625 +06:00 [INF] Executed DbCommand (390ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:27:39.631 +06:00 [WRN] Invalid password for user a5a1c23a-b88f-40c5-984a-b267ba521fd6.
2019-10-23 22:27:39.631 +06:00 [WRN] User a5a1c23a-b88f-40c5-984a-b267ba521fd6 failed to provide the correct password.
2019-10-23 22:27:39.632 +06:00 [ERR] Ошибка авторизации пользователя: oneb.impulse@gmail.com
2019-10-23 22:27:39.764 +06:00 [ERR] HSCFiscalRegistrar.Exceptions.AuthorizeException: Неверный логин или пароль
   at HSCFiscalRegistrar.Controllers.AuthorizeController.Post(UserDTO model) in C:\Users\Ibragim\Desktop\csharp\ESDP\2\HSCFiscal\HSCFiscalRegistrar\HSCFiscalRegistrar\Controllers\AuthorizeController.cs:line 66
2019-10-23 22:27:39.764 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 529.4248ms.
2019-10-23 22:27:39.764 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:27:39.764 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 4936.0026ms
2019-10-23 22:27:39.764 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:27:39.764 +06:00 [INF] Request finished in 4937.0963ms 200 text/plain; charset=utf-8
2019-10-23 22:28:02.890 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 55
2019-10-23 22:28:02.890 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:28:02.890 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 22:28:02.891 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:28:04.591 +06:00 [INF] Executed DbCommand (499ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:28:04.591 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:28:04.592 +06:00 [INF] Autorize|Post
2019-10-23 22:28:04.592 +06:00 [INF] Авторизация пользователя: oneb.impulse@gmail.com:Aa!1234
2019-10-23 22:28:05.050 +06:00 [INF] Executed DbCommand (457ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:28:05.451 +06:00 [INF] Executed DbCommand (397ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 22:28:05.859 +06:00 [INF] Executed DbCommand (406ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 22:28:06.318 +06:00 [INF] Executed DbCommand (458ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 22:28:06.741 +06:00 [INF] Executed DbCommand (420ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 22:28:06.742 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 22:28:07.495 +06:00 [INF] Executed DbCommand (752ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 22:28:08.418 +06:00 [INF] Executed DbCommand (922ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:28:08.831 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 22:28:09.200 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4608.4688000000006ms.
2019-10-23 22:28:09.200 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:28:09.201 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 6310.0709000000006ms
2019-10-23 22:28:09.201 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:28:09.201 +06:00 [INF] Request finished in 6311.3413ms 200 text/plain; charset=utf-8
2019-10-23 22:28:09.453 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 71
2019-10-23 22:28:09.458 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:28:09.459 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 22:28:09.459 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:28:11.042 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:28:11.042 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:28:11.043 +06:00 [INF] Cashbox|Post
2019-10-23 22:28:11.043 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 22:28:11.508 +06:00 [INF] Executed DbCommand (464ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 22:28:11.881 +06:00 [INF] Executed DbCommand (372ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 22:28:12.278 +06:00 [INF] Executed DbCommand (396ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:28:12.668 +06:00 [INF] Executed DbCommand (389ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 22:28:13.073 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 22:28:13.074 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2031.1113ms.
2019-10-23 22:28:13.074 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:28:13.074 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 3615.2816000000003ms
2019-10-23 22:28:13.074 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:28:13.074 +06:00 [INF] Request finished in 3621.3673ms 200 text/plain; charset=utf-8
2019-10-23 22:28:13.269 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 106
2019-10-23 22:28:13.269 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:28:13.269 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 22:28:13.270 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:28:14.842 +06:00 [INF] Executed DbCommand (364ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:28:14.843 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:28:15.223 +06:00 [INF] Executed DbCommand (379ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 22:28:15.640 +06:00 [INF] Executed DbCommand (416ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:28:16.039 +06:00 [INF] Executed DbCommand (398ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 22:28:16.481 +06:00 [INF] Executed DbCommand (441ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 22:28:16.880 +06:00 [INF] Executed DbCommand (397ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:17.258 +06:00 [INF] Executed DbCommand (377ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:17.697 +06:00 [INF] Executed DbCommand (439ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:18.099 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:18.531 +06:00 [INF] Executed DbCommand (430ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:18.908 +06:00 [INF] Executed DbCommand (377ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:19.348 +06:00 [INF] Executed DbCommand (439ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:19.760 +06:00 [INF] Executed DbCommand (411ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:20.192 +06:00 [INF] Executed DbCommand (431ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:20.603 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:20.970 +06:00 [INF] Executed DbCommand (367ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:21.371 +06:00 [INF] Executed DbCommand (401ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:21.788 +06:00 [INF] Executed DbCommand (416ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:22.182 +06:00 [INF] Executed DbCommand (393ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:22.582 +06:00 [INF] Executed DbCommand (398ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:22.988 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:23.407 +06:00 [INF] Executed DbCommand (418ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:23.853 +06:00 [INF] Executed DbCommand (445ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:24.244 +06:00 [INF] Executed DbCommand (390ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:24.660 +06:00 [INF] Executed DbCommand (415ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:28:25.051 +06:00 [INF] Executed DbCommand (390ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:28:25.438 +06:00 [INF] Executed DbCommand (387ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:28:25.818 +06:00 [INF] Executed DbCommand (380ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:28:26.248 +06:00 [INF] Executed DbCommand (429ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:28:26.657 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:28:27.068 +06:00 [INF] Executed DbCommand (410ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 22:28:27.459 +06:00 [INF] Executed DbCommand (390ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:28:27.869 +06:00 [INF] Executed DbCommand (409ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:28:28.268 +06:00 [INF] Executed DbCommand (398ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 22:28:28.674 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 22:28:29.052 +06:00 [INF] OfdXReport|Post
2019-10-23 22:28:29.052 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 22:28:29.056 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 14212.712300000001ms.
2019-10-23 22:28:29.056 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:28:29.057 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 15787.392600000001ms
2019-10-23 22:28:29.057 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:28:29.057 +06:00 [INF] Request finished in 15788.291ms 200 text/plain; charset=utf-8
2019-10-23 22:50:23.507 +06:00 [INF] Starting web host
2019-10-23 22:50:25.578 +06:00 [INF] User profile is available. Using 'C:\Users\Ibragim\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-23 22:50:27.032 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:50:35.099 +06:00 [INF] Executed DbCommand (450ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:51:08.604 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Authorize application/json; charset=utf-8 56
2019-10-23 22:51:08.619 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-23 22:51:08.689 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:51:08.719 +06:00 [INF] Route matched with {action = "Post", controller = "Authorize"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.UserModel.UserDTO) on controller HSCFiscalRegistrar.Controllers.AuthorizeController (HSCFiscalRegistrar).
2019-10-23 22:51:08.727 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:51:10.097 +06:00 [INF] Executed DbCommand (364ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:51:10.305 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:51:10.309 +06:00 [INF] Autorize|Post
2019-10-23 22:51:10.310 +06:00 [INF] Авторизация пользователя: mamedov.r9657@gmail.com:Aa!1234
2019-10-23 22:51:10.844 +06:00 [INF] Executed DbCommand (385ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:51:11.426 +06:00 [INF] Executed DbCommand (359ms) [Parameters=[@__user_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT uc."Id", uc."ClaimType", uc."ClaimValue", uc."UserId"
FROM "AspNetUserClaims" AS uc
WHERE uc."UserId" = @__user_Id_0
2019-10-23 22:51:11.776 +06:00 [INF] Executed DbCommand (317ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT role."Name"
FROM "AspNetUserRoles" AS "userRole"
INNER JOIN "AspNetRoles" AS role ON "userRole"."RoleId" = role."Id"
WHERE "userRole"."UserId" = @__userId_0
2019-10-23 22:51:12.164 +06:00 [INF] Executed DbCommand (362ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."ConcurrencyStamp", r."Name", r."NormalizedName"
FROM "AspNetRoles" AS r
WHERE r."NormalizedName" = @__normalizedName_0
LIMIT 1
2019-10-23 22:51:12.534 +06:00 [INF] Executed DbCommand (322ms) [Parameters=[@__role_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT rc."ClaimType", rc."ClaimValue"
FROM "AspNetRoleClaims" AS rc
WHERE rc."RoleId" = @__role_Id_0
2019-10-23 22:51:12.561 +06:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-10-23 22:51:12.945 +06:00 [INF] Executed DbCommand (360ms) [Parameters=[@__model_Login_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AccessFailedCount", r."Address", r."ConcurrencyStamp", r."DateTimeCreationToken", r."Email", r."EmailConfirmed", r."ExpiryDate", r."Fio", r."Inn", r."KkmId", r."LockoutEnabled", r."LockoutEnd", r."NormalizedEmail", r."NormalizedUserName", r."Okved", r."OperatorCode", r."OwnerId", r."PasswordHash", r."PhoneNumber", r."PhoneNumberConfirmed", r."SecurityStamp", r."TaxationType", r."Title", r."TwoFactorEnabled", r."UserName", r."UserToken", r."UserType", r."VAT", r."VATNumber", r."VATSeria"
FROM "AspNetUsers" AS r
WHERE r."Email" = @__model_Login_0
LIMIT 2
2019-10-23 22:51:13.310 +06:00 [INF] Executed DbCommand (345ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2019-10-23 22:51:13.898 +06:00 [INF] Executed DbCommand (479ms) [Parameters=[@p30='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p31='?', @p3='?' (DbType = DateTime), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?', @p15='?' (DbType = Int32), @p16='?', @p17='?', @p18='?', @p19='?' (DbType = Boolean), @p20='?', @p21='?' (DbType = Int32), @p22='?', @p23='?' (DbType = Boolean), @p24='?' (Size = 256), @p25='?', @p26='?' (DbType = Int32), @p27='?' (DbType = Boolean), @p28='?', @p29='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Address" = @p1, "ConcurrencyStamp" = @p2, "DateTimeCreationToken" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "ExpiryDate" = @p6, "Fio" = @p7, "Inn" = @p8, "KkmId" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "Okved" = @p14, "OperatorCode" = @p15, "OwnerId" = @p16, "PasswordHash" = @p17, "PhoneNumber" = @p18, "PhoneNumberConfirmed" = @p19, "SecurityStamp" = @p20, "TaxationType" = @p21, "Title" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24, "UserToken" = @p25, "UserType" = @p26, "VAT" = @p27, "VATNumber" = @p28, "VATSeria" = @p29
WHERE "Id" = @p30 AND "ConcurrencyStamp" = @p31;
2019-10-23 22:51:14.775 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4467.8461000000007ms.
2019-10-23 22:51:14.786 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:51:14.799 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar) in 6077.1596ms
2019-10-23 22:51:14.800 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.AuthorizeController.Post (HSCFiscalRegistrar)'
2019-10-23 22:51:14.807 +06:00 [INF] Request finished in 6203.4851ms 200 text/plain; charset=utf-8
2019-10-23 22:51:14.937 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/Cashboxes application/json; charset=utf-8 71
2019-10-23 22:51:14.942 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:51:14.948 +06:00 [INF] Route matched with {action = "Get", controller = "Cashboxes"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.ActionResult Get(Models.DTO.Cashboxes.DtoToken) on controller HSCFiscalRegistrar.Controllers.CashboxesController (HSCFiscalRegistrar).
2019-10-23 22:51:14.951 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:51:16.975 +06:00 [INF] Executed DbCommand (355ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:51:16.978 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:51:16.980 +06:00 [INF] Cashbox|Post
2019-10-23 22:51:16.980 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-23 22:51:17.382 +06:00 [INF] Executed DbCommand (367ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-23 22:51:17.761 +06:00 [INF] Executed DbCommand (340ms) [Parameters=[@__dtoToken_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."AccessFailedCount", i."Address", i."ConcurrencyStamp", i."DateTimeCreationToken", i."Email", i."EmailConfirmed", i."ExpiryDate", i."Fio", i."Inn", i."KkmId", i."LockoutEnabled", i."LockoutEnd", i."NormalizedEmail", i."NormalizedUserName", i."Okved", i."OperatorCode", i."OwnerId", i."PasswordHash", i."PhoneNumber", i."PhoneNumberConfirmed", i."SecurityStamp", i."TaxationType", i."Title", i."TwoFactorEnabled", i."UserName", i."UserToken", i."UserType", i."VAT", i."VATNumber", i."VATSeria"
FROM "AspNetUsers" AS i
WHERE i."UserToken" = @__dtoToken_Token_0
LIMIT 1
2019-10-23 22:51:18.227 +06:00 [INF] Executed DbCommand (445ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:51:18.620 +06:00 [INF] Executed DbCommand (332ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s
        WHERE s."KkmId" = @__kkm_Id_0)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 22:51:18.655 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1676.2944ms.
2019-10-23 22:51:18.655 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:51:18.656 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar) in 3707.6717000000003ms
2019-10-23 22:51:18.656 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CashboxesController.Get (HSCFiscalRegistrar)'
2019-10-23 22:51:18.656 +06:00 [INF] Request finished in 3719.4878ms 200 text/plain; charset=utf-8
2019-10-23 22:51:18.820 +06:00 [INF] Request starting HTTP/1.1 POST http://192.168.8.105:6001/api/XReport application/json; charset=utf-8 104
2019-10-23 22:51:18.820 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:51:18.827 +06:00 [INF] Route matched with {action = "Post", controller = "XReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.XReportController (HSCFiscalRegistrar).
2019-10-23 22:51:18.827 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-23 22:51:20.322 +06:00 [INF] Executed DbCommand (352ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-23 22:51:20.326 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-23 22:51:20.885 +06:00 [INF] Executed DbCommand (529ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-23 22:51:21.660 +06:00 [INF] Executed DbCommand (758ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-23 22:51:22.022 +06:00 [INF] Executed DbCommand (342ms) [Parameters=[@__user_OwnerId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE @__user_OwnerId_0 = u."Id"
LIMIT 1
2019-10-23 22:51:22.036 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 22:51:22.453 +06:00 [INF] Executed DbCommand (405ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE (s."KkmId" = @__kkm_Id_0) AND (s."CloseDate" = TIMESTAMP '0001-01-01 00:00:00')
2019-10-23 22:51:22.552 +06:00 [ERR] An exception occurred while iterating over the results of a query for context type 'HSCFiscalRegistrar.ApplicationContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-10-23 22:51:22.553 +06:00 [ERR] An exception occurred while iterating over the results of a query for context type 'HSCFiscalRegistrar.ApplicationContext'.
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: Sequence contains no elements
   at System.Linq.Enumerable.Last[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-10-23 22:51:22.962 +06:00 [INF] Executed DbCommand (324ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-23 22:51:22.965 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-23 22:51:22.973 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-23 22:51:23.302 +06:00 [INF] Executed DbCommand (326ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 22:51:23.843 +06:00 [INF] Executed DbCommand (500ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-23 22:51:24.500 +06:00 [INF] Executed DbCommand (618ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:24.861 +06:00 [INF] Executed DbCommand (351ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:25.213 +06:00 [INF] Executed DbCommand (328ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:25.535 +06:00 [INF] Executed DbCommand (313ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:25.870 +06:00 [INF] Executed DbCommand (328ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:26.222 +06:00 [INF] Executed DbCommand (350ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:26.590 +06:00 [INF] Executed DbCommand (367ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:26.943 +06:00 [INF] Executed DbCommand (352ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:27.294 +06:00 [INF] Executed DbCommand (351ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:27.625 +06:00 [INF] Executed DbCommand (330ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:27.972 +06:00 [INF] Executed DbCommand (346ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:28.291 +06:00 [INF] Executed DbCommand (318ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:28.665 +06:00 [INF] Executed DbCommand (373ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:29.021 +06:00 [INF] Executed DbCommand (356ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:29.586 +06:00 [INF] Executed DbCommand (564ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:29.954 +06:00 [INF] Executed DbCommand (368ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:30.516 +06:00 [INF] Executed DbCommand (561ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:30.885 +06:00 [INF] Executed DbCommand (368ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:31.320 +06:00 [INF] Executed DbCommand (435ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:31.661 +06:00 [INF] Executed DbCommand (340ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-23 22:51:32.011 +06:00 [INF] Executed DbCommand (337ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:51:32.368 +06:00 [INF] Executed DbCommand (351ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:51:32.732 +06:00 [INF] Executed DbCommand (355ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:51:33.271 +06:00 [INF] Executed DbCommand (538ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:51:33.652 +06:00 [INF] Executed DbCommand (378ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-23 22:51:34.001 +06:00 [INF] Executed DbCommand (341ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-23 22:51:34.456 +06:00 [INF] Executed DbCommand (454ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-23 22:51:34.885 +06:00 [INF] Executed DbCommand (429ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-23 22:51:35.484 +06:00 [INF] Executed DbCommand (580ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-23 22:51:35.986 +06:00 [INF] Executed DbCommand (392ms) [Parameters=[@p1='?', @p0='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Decimal), @p10='?', @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?', @p17='?' (DbType = Decimal), @p18='?', @p19='?' (DbType = Decimal), @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Int32), @p23='?' (DbType = Int32), @p24='?', @p25='?' (DbType = Decimal), @p26='?', @p27='?' (DbType = Decimal), @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Int32), @p31='?' (DbType = Int32), @p32='?', @p33='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "ReqNum" = @p0
WHERE "Id" = @p1;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33);
2019-10-23 22:51:36.586 +06:00 [INF] OfdXReport|Post
2019-10-23 22:51:36.586 +06:00 [INF] Отправка запроса на Х-Отчет в ОФД
2019-10-23 22:51:36.812 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 16485.7026ms.
2019-10-23 22:51:36.812 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-23 22:51:36.812 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar) in 17985.5425ms
2019-10-23 22:51:36.812 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.XReportController.Post (HSCFiscalRegistrar)'
2019-10-23 22:51:36.813 +06:00 [INF] Request finished in 17993.0073ms 200 text/plain; charset=utf-8
2019-10-24 14:40:43.013 +06:00 [INF] Starting web host
2019-10-24 14:40:44.572 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 14:40:45.555 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 14:40:48.734 +06:00 [INF] Executed DbCommand (279ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 14:40:49.105 +06:00 [FTL] Unable to start Kestrel.
System.Net.Sockets.SocketException (10049): The requested address is not valid in its context
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-10-24 14:40:49.169 +06:00 [FTL] Host terminated unexpectedly
System.Net.Sockets.SocketException (10049): The requested address is not valid in its context
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token, String shutdownMessage)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.Run(IWebHost host)
   at HSCFiscalRegistrar.Program.Main(String[] args) in C:\Users\Dell\Desktop\master\HSCFiscal\HSCFiscalRegistrar\HSCFiscalRegistrar\Program.cs:line 36
2019-10-24 14:43:08.974 +06:00 [INF] Starting web host
2019-10-24 14:43:10.718 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 14:43:12.187 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 14:43:15.115 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 14:43:15.491 +06:00 [FTL] Unable to start Kestrel.
System.Net.Sockets.SocketException (10049): The requested address is not valid in its context
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-10-24 14:43:15.549 +06:00 [FTL] Host terminated unexpectedly
System.Net.Sockets.SocketException (10049): The requested address is not valid in its context
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token, String shutdownMessage)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.Run(IWebHost host)
   at HSCFiscalRegistrar.Program.Main(String[] args) in C:\Users\Dell\Desktop\master\HSCFiscal\HSCFiscalRegistrar\HSCFiscalRegistrar\Program.cs:line 36
2019-10-24 14:46:07.620 +06:00 [INF] Starting web host
2019-10-24 14:46:08.892 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 14:46:10.131 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 14:46:12.825 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 14:46:13.138 +06:00 [FTL] Unable to start Kestrel.
System.Net.Sockets.SocketException (10049): The requested address is not valid in its context
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-10-24 14:46:13.192 +06:00 [FTL] Host terminated unexpectedly
System.Net.Sockets.SocketException (10049): The requested address is not valid in its context
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token, String shutdownMessage)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token)
   at Microsoft.AspNetCore.Hosting.WebHostExtensions.Run(IWebHost host)
   at HSCFiscalRegistrar.Program.Main(String[] args) in C:\Users\Dell\Desktop\master\HSCFiscal\HSCFiscalRegistrar\HSCFiscalRegistrar\Program.cs:line 36
2019-10-24 14:46:41.012 +06:00 [INF] Starting web host
2019-10-24 14:46:42.087 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 14:46:43.088 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 14:55:33.289 +06:00 [INF] Starting web host
2019-10-24 14:55:34.467 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 14:55:35.578 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:12:38.604 +06:00 [INF] Starting web host
2019-10-24 15:12:39.938 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 15:12:41.036 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:12:43.959 +06:00 [INF] Executed DbCommand (274ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:12:44.592 +06:00 [INF] Request starting HTTP/1.1 GET http://localhost:6001/api/values  
2019-10-24 15:12:44.599 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-24 15:12:44.639 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:12:44.651 +06:00 [INF] Route matched with {action = "Index", controller = "Values"}. Executing controller action with signature System.String Index() on controller HSCFiscalRegistrar.Controllers.ValuesController (HSCFiscalRegistrar).
2019-10-24 15:12:44.657 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:12:44.658 +06:00 [INF] Serialog на старте!
2019-10-24 15:12:44.660 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.4867ms.
2019-10-24 15:12:44.667 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:12:44.685 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) in 31.818ms
2019-10-24 15:12:44.685 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:12:44.687 +06:00 [INF] Request finished in 95.9331ms 200 text/plain; charset=utf-8
2019-10-24 15:12:44.701 +06:00 [INF] Request starting HTTP/1.1 GET http://localhost:6001/favicon.ico  
2019-10-24 15:12:44.705 +06:00 [INF] Request finished in 3.7585ms 404 
2019-10-24 15:14:15.432 +06:00 [INF] Connection id "0HLQOC9A7P5TJ" bad request data: "Invalid request line: '\x16\x03\x01\x02\x00\x01\x00\x01\xFC\x03\x03\x00\xE5\x7F\xB9V\xBF\xAE\x1C~\x1El\x92i|\xA12\xA6}\xA8?\x1F\xE6TR\x17}$$\x1EK\x03. \x04\xFBW\xCCI\x16^\xB5\xDDr]r\xDEv\xFF\x02A\x91b\x177\xB4|\x9C\x9AG\x93,G\xCF\x85\xC0\x00"::\x13\x01\x13\x02\x13\x03\xC0+\xC0/\xC0,\xC00\xCC\xA9\xCC\xA8\xC0\x13\xC0\x14\x00\x9C\x00\x9D\x00/\x005\x00\x0A'"
Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Invalid request line: '\x16\x03\x01\x02\x00\x01\x00\x01\xFC\x03\x03\x00\xE5\x7F\xB9V\xBF\xAE\x1C~\x1El\x92i|\xA12\xA6}\xA8?\x1F\xE6TR\x17}$$\x1EK\x03. \x04\xFBW\xCCI\x16^\xB5\xDDr]r\xDEv\xFF\x02A\x91b\x177\xB4|\x9C\x9AG\x93,G\xCF\x85\xC0\x00"::\x13\x01\x13\x02\x13\x03\xC0+\xC0/\xC0,\xC00\xCC\xA9\xCC\xA8\xC0\x13\xC0\x14\x00\x9C\x00\x9D\x00/\x005\x00\x0A'
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.RejectRequestLine(Byte* requestLine, Int32 length)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.GetUnknownMethod(Byte* data, Int32 length, Int32& methodLength)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, Byte* data, Int32 length)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, ReadOnlySequence`1& buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.IHttpParser<TRequestHandler>.ParseRequestLine(TRequestHandler handler, ReadOnlySequence`1& buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TakeStartLine(ReadOnlySequence`1 buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.ParseRequest(ReadOnlySequence`1 buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TryParseRequest(ReadResult result, Boolean& endConnection)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application)
2019-10-24 15:14:15.432 +06:00 [INF] Connection id "0HLQOC9A7P5TK" bad request data: "Invalid request line: '\x16\x03\x01\x02\x00\x01\x00\x01\xFC\x03\x03shw\x88e\xAC\xF3B~`\xCA\xE3"\x0F\x0D\xB2\xFAOF\xA1\x8E\xFD\xAF\x13\x8E\xE9\x08\x113\xE9\xD5l \xAC/\x06N^\x19\x96w\xB5\xEB+JZ\xC4\x11\x0C\xABIt\xBB\xCE\x1B\xF2\xF7f\xC5\xC0}1\x8F\xE7\xDF\x00"\x9A\x9A\x13\x01\x13\x02\x13\x03\xC0+\xC0/\xC0,\xC00\xCC\xA9\xCC\xA8\xC0\x13\xC0\x14\x00\x9C\x00\x9D\x00/\x005\x00\x0A'"
Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Invalid request line: '\x16\x03\x01\x02\x00\x01\x00\x01\xFC\x03\x03shw\x88e\xAC\xF3B~`\xCA\xE3"\x0F\x0D\xB2\xFAOF\xA1\x8E\xFD\xAF\x13\x8E\xE9\x08\x113\xE9\xD5l \xAC/\x06N^\x19\x96w\xB5\xEB+JZ\xC4\x11\x0C\xABIt\xBB\xCE\x1B\xF2\xF7f\xC5\xC0}1\x8F\xE7\xDF\x00"\x9A\x9A\x13\x01\x13\x02\x13\x03\xC0+\xC0/\xC0,\xC00\xCC\xA9\xCC\xA8\xC0\x13\xC0\x14\x00\x9C\x00\x9D\x00/\x005\x00\x0A'
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.RejectRequestLine(Byte* requestLine, Int32 length)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.GetUnknownMethod(Byte* data, Int32 length, Int32& methodLength)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, Byte* data, Int32 length)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, ReadOnlySequence`1& buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.IHttpParser<TRequestHandler>.ParseRequestLine(TRequestHandler handler, ReadOnlySequence`1& buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TakeStartLine(ReadOnlySequence`1 buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.ParseRequest(ReadOnlySequence`1 buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TryParseRequest(ReadResult result, Boolean& endConnection)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application)
2019-10-24 15:14:20.688 +06:00 [INF] Request starting HTTP/1.1 GET http://localhost:6001/api/values  
2019-10-24 15:14:20.690 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:14:20.691 +06:00 [INF] Route matched with {action = "Index", controller = "Values"}. Executing controller action with signature System.String Index() on controller HSCFiscalRegistrar.Controllers.ValuesController (HSCFiscalRegistrar).
2019-10-24 15:14:20.691 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:14:20.691 +06:00 [INF] Serialog на старте!
2019-10-24 15:14:20.691 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.091900000000000009ms.
2019-10-24 15:14:20.692 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:14:20.692 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) in 1.327ms
2019-10-24 15:14:20.692 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:14:20.693 +06:00 [INF] Request finished in 4.3161ms 200 text/plain; charset=utf-8
2019-10-24 15:14:30.426 +06:00 [INF] Connection id "0HLQOC9A7P5TN" bad request data: "Invalid request line: '\x16\x03\x01\x00\xE1\x01\x00\x00\xDD\x03\x03\x1D$s\xAD\x0Dk\xC1#\x92\xF7\xD9\x01\x8Do\xB9)\xF2\x8A\x80\xFB\xBAN\x1E\x8B\x06\x06\x15]\xD2\xD2\xF2_\x00\x00\\xC0/\xC0+\xC00\xC0,\x00\x9E\xC0'\x00g\xC0(\x00k\x00\xA3\x00\x9F\xCC\xA9\xCC\xA8\xCC\xAA\xC0\xAF\xC0\xAD\xC0\xA3\xC0\x9F\x00\xA2\xC0\xAE\xC0\xAC\xC0\xA2\xC0\x9E\xC0$\x00j\xC0#\x00@\xC0\x0A'"
Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Invalid request line: '\x16\x03\x01\x00\xE1\x01\x00\x00\xDD\x03\x03\x1D$s\xAD\x0Dk\xC1#\x92\xF7\xD9\x01\x8Do\xB9)\xF2\x8A\x80\xFB\xBAN\x1E\x8B\x06\x06\x15]\xD2\xD2\xF2_\x00\x00\\xC0/\xC0+\xC00\xC0,\x00\x9E\xC0'\x00g\xC0(\x00k\x00\xA3\x00\x9F\xCC\xA9\xCC\xA8\xCC\xAA\xC0\xAF\xC0\xAD\xC0\xA3\xC0\x9F\x00\xA2\xC0\xAE\xC0\xAC\xC0\xA2\xC0\x9E\xC0$\x00j\xC0#\x00@\xC0\x0A'
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.RejectRequestLine(Byte* requestLine, Int32 length)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.GetUnknownMethod(Byte* data, Int32 length, Int32& methodLength)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, Byte* data, Int32 length)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, ReadOnlySequence`1& buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.IHttpParser<TRequestHandler>.ParseRequestLine(TRequestHandler handler, ReadOnlySequence`1& buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TakeStartLine(ReadOnlySequence`1 buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.ParseRequest(ReadOnlySequence`1 buffer, SequencePosition& consumed, SequencePosition& examined)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TryParseRequest(ReadResult result, Boolean& endConnection)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application)
2019-10-24 15:14:34.238 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/Check application/json 1392
2019-10-24 15:14:34.238 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:14:34.251 +06:00 [INF] Route matched with {action = "Post", controller = "Check"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.Fiscalization.KKM.CheckOperationRequest) on controller HSCFiscalRegistrar.Controllers.CheckController (HSCFiscalRegistrar).
2019-10-24 15:14:34.253 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:14:35.637 +06:00 [INF] Executed DbCommand (266ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:14:35.747 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:14:35.748 +06:00 [INF] Check|Post
2019-10-24 15:14:35.748 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-24 15:14:35.748 +06:00 [INF] Информация по чеку: 2bbfb42a-ff83-440f-88ea-9d9977647ccd%KMoYJVnFVUmSik1cRllyqw
2019-10-24 15:14:36.120 +06:00 [INF] Executed DbCommand (273ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-24 15:14:36.210 +06:00 [ERR] Object reference not set to an instance of an object.
2019-10-24 15:14:36.210 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.JsonResult in 463.2828ms.
2019-10-24 15:14:36.212 +06:00 [INF] Executing JsonResult, writing value of type 'System.String'.
2019-10-24 15:14:36.224 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) in 1972.0022000000001ms
2019-10-24 15:14:36.224 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:14:36.224 +06:00 [INF] Request finished in 1986.7513ms 200 application/json; charset=utf-8
2019-10-24 15:14:48.458 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/Check application/json 1392
2019-10-24 15:14:48.458 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:14:48.458 +06:00 [INF] Route matched with {action = "Post", controller = "Check"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.Fiscalization.KKM.CheckOperationRequest) on controller HSCFiscalRegistrar.Controllers.CheckController (HSCFiscalRegistrar).
2019-10-24 15:14:48.458 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:14:49.515 +06:00 [INF] Executed DbCommand (267ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:14:49.516 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:14:49.516 +06:00 [INF] Check|Post
2019-10-24 15:14:49.516 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-24 15:14:49.516 +06:00 [INF] Информация по чеку: 2bbfb42a-ff83-440f-88ea-9d9977647ccd%KMoYJVnFVUmSik1cRllyqw
2019-10-24 15:14:49.785 +06:00 [INF] Executed DbCommand (266ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-24 15:14:49.851 +06:00 [ERR] Object reference not set to an instance of an object.
2019-10-24 15:14:49.852 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.JsonResult in 335.3127ms.
2019-10-24 15:14:49.852 +06:00 [INF] Executing JsonResult, writing value of type 'System.String'.
2019-10-24 15:14:49.852 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) in 1393.9326ms
2019-10-24 15:14:49.852 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:14:49.852 +06:00 [INF] Request finished in 1394.5184ms 200 application/json; charset=utf-8
2019-10-24 15:16:03.498 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/Check application/json 1390
2019-10-24 15:16:03.498 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:16:03.498 +06:00 [INF] Route matched with {action = "Post", controller = "Check"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.Fiscalization.KKM.CheckOperationRequest) on controller HSCFiscalRegistrar.Controllers.CheckController (HSCFiscalRegistrar).
2019-10-24 15:16:03.499 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:16:04.544 +06:00 [INF] Executed DbCommand (266ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:16:04.545 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:16:04.545 +06:00 [INF] Check|Post
2019-10-24 15:16:04.545 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-24 15:16:04.545 +06:00 [INF] Информация по чеку: a5a1c23a-b88f-40c5-984a-b267ba521fd6%oe7vj3t8wkeqP8d2ogvg
2019-10-24 15:16:04.814 +06:00 [INF] Executed DbCommand (268ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-24 15:16:07.586 +06:00 [INF] Executed DbCommand (265ms) [Parameters=[@__checkOperationRequest_CashboxUniqueNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."SerialNumber" = @__checkOperationRequest_CashboxUniqueNumber_0
LIMIT 1
2019-10-24 15:16:08.996 +06:00 [INF] Executed DbCommand (266ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-24 15:16:08.998 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-24 15:16:09.001 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-24 15:16:09.268 +06:00 [INF] Executed DbCommand (265ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:16:09.548 +06:00 [INF] Executed DbCommand (265ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:16:10.761 +06:00 [INF] Executed DbCommand (265ms) [Parameters=[@__kkm_UserId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."Id" = @__kkm_UserId_0
LIMIT 1
2019-10-24 15:16:16.561 +06:00 [INF] Executed DbCommand (265ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS s
WHERE s."ShiftId" = @__shift_Id_0
2019-10-24 15:16:36.856 +06:00 [INF] Executed DbCommand (273ms) [Parameters=[@p19='?', @p0='?', @p1='?', @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?', @p14='?' (DbType = Int32), @p15='?', @p16='?', @p17='?', @p18='?', @p20='?', @p21='?' (DbType = Decimal), @p22='?' (DbType = Decimal), @p23='?' (DbType = Decimal), @p24='?' (DbType = Decimal), @p25='?' (DbType = Decimal), @p26='?' (DbType = Int32), @p27='?' (DbType = DateTime), @p28='?', @p29='?' (DbType = Boolean), @p30='?', @p31='?' (DbType = Int32), @p32='?', @p33='?', @p34='?' (DbType = Int32), @p35='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "Address" = @p0, "CurrentStatus" = @p1, "Description" = @p2, "DeviceId" = @p3, "FnsKkmId" = @p4, "IdentificationNumber" = @p5, "Iin" = @p6, "LastDateOperation" = @p7, "Mode" = @p8, "Name" = @p9, "NameOrg" = @p10, "OfdToken" = @p11, "OperatorId" = @p12, "PointOfPayment" = @p13, "ReqNum" = @p14, "SerialNumber" = @p15, "TerminalNumber" = @p16, "UserId" = @p17, "UserId1" = @p18
WHERE "Id" = @p19;
INSERT INTO "Operations" ("Id", "Amount", "CardAmount", "CashAmount", "CashAmountFromClient", "ChangeAmount", "CheckNumber", "CreationDate", "FiscalNumber", "IsOffline", "KkmId", "OperationState", "QR", "ShiftId", "Type", "UserId")
VALUES (@p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35);
2019-10-24 15:16:40.627 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 36081.5585ms.
2019-10-24 15:16:40.630 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:16:40.631 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) in 37132.1338ms
2019-10-24 15:16:40.631 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:16:40.632 +06:00 [INF] Request finished in 37134.4966ms 200 text/plain; charset=utf-8
2019-10-24 15:17:44.692 +06:00 [INF] Starting web host
2019-10-24 15:17:45.962 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 15:17:47.127 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:17:49.818 +06:00 [INF] Executed DbCommand (265ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:17:50.717 +06:00 [INF] Request starting HTTP/1.1 GET http://localhost:6001/api/values  
2019-10-24 15:17:50.725 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-24 15:17:50.805 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:17:50.818 +06:00 [INF] Route matched with {action = "Index", controller = "Values"}. Executing controller action with signature System.String Index() on controller HSCFiscalRegistrar.Controllers.ValuesController (HSCFiscalRegistrar).
2019-10-24 15:17:50.827 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:17:50.827 +06:00 [INF] Serialog на старте!
2019-10-24 15:17:50.829 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.5043ms.
2019-10-24 15:17:50.835 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:17:50.851 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) in 31.1304ms
2019-10-24 15:17:50.851 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:17:50.854 +06:00 [INF] Request finished in 138.1331ms 200 text/plain; charset=utf-8
2019-10-24 15:17:53.168 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/Check application/json 1390
2019-10-24 15:17:53.170 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:17:53.183 +06:00 [INF] Route matched with {action = "Post", controller = "Check"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.Fiscalization.KKM.CheckOperationRequest) on controller HSCFiscalRegistrar.Controllers.CheckController (HSCFiscalRegistrar).
2019-10-24 15:17:53.189 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:17:54.228 +06:00 [INF] Executed DbCommand (255ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:17:54.344 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:17:54.347 +06:00 [INF] Check|Post
2019-10-24 15:17:54.347 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-24 15:17:54.347 +06:00 [INF] Информация по чеку: a5a1c23a-b88f-40c5-984a-b267ba521fd6%oe7vj3t8wkeqP8d2ogvg
2019-10-24 15:17:54.700 +06:00 [INF] Executed DbCommand (264ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-24 15:17:55.053 +06:00 [INF] Executed DbCommand (255ms) [Parameters=[@__checkOperationRequest_CashboxUniqueNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."SerialNumber" = @__checkOperationRequest_CashboxUniqueNumber_0
LIMIT 1
2019-10-24 15:17:55.330 +06:00 [INF] Executed DbCommand (255ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-24 15:17:55.333 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-24 15:17:55.336 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-24 15:17:55.594 +06:00 [INF] Executed DbCommand (255ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:17:55.863 +06:00 [INF] Executed DbCommand (255ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:17:56.126 +06:00 [INF] Executed DbCommand (255ms) [Parameters=[@__kkm_UserId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."Id" = @__kkm_UserId_0
LIMIT 1
2019-10-24 15:17:56.393 +06:00 [INF] Executed DbCommand (255ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS s
WHERE s."ShiftId" = @__shift_Id_0
2019-10-24 15:17:58.612 +06:00 [INF] Executed DbCommand (262ms) [Parameters=[@p19='?', @p0='?', @p1='?', @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?', @p14='?' (DbType = Int32), @p15='?', @p16='?', @p17='?', @p18='?', @p20='?', @p21='?' (DbType = Decimal), @p22='?' (DbType = Decimal), @p23='?' (DbType = Decimal), @p24='?' (DbType = Decimal), @p25='?' (DbType = Decimal), @p26='?' (DbType = Int32), @p27='?' (DbType = DateTime), @p28='?', @p29='?' (DbType = Boolean), @p30='?', @p31='?' (DbType = Int32), @p32='?', @p33='?', @p34='?' (DbType = Int32), @p35='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "Address" = @p0, "CurrentStatus" = @p1, "Description" = @p2, "DeviceId" = @p3, "FnsKkmId" = @p4, "IdentificationNumber" = @p5, "Iin" = @p6, "LastDateOperation" = @p7, "Mode" = @p8, "Name" = @p9, "NameOrg" = @p10, "OfdToken" = @p11, "OperatorId" = @p12, "PointOfPayment" = @p13, "ReqNum" = @p14, "SerialNumber" = @p15, "TerminalNumber" = @p16, "UserId" = @p17, "UserId1" = @p18
WHERE "Id" = @p19;
INSERT INTO "Operations" ("Id", "Amount", "CardAmount", "CashAmount", "CashAmountFromClient", "ChangeAmount", "CheckNumber", "CreationDate", "FiscalNumber", "IsOffline", "KkmId", "OperationState", "QR", "ShiftId", "Type", "UserId")
VALUES (@p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35);
2019-10-24 15:17:58.887 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4542.8194ms.
2019-10-24 15:17:58.890 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:17:58.891 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) in 5707.9646ms
2019-10-24 15:17:58.891 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:17:58.893 +06:00 [INF] Request finished in 5725.7897ms 200 text/plain; charset=utf-8
2019-10-24 15:19:48.287 +06:00 [INF] Starting web host
2019-10-24 15:19:49.558 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 15:19:50.675 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:19:53.385 +06:00 [INF] Executed DbCommand (269ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:19:53.867 +06:00 [INF] Request starting HTTP/1.1 GET http://localhost:6001/api/values  
2019-10-24 15:19:53.874 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-24 15:19:53.915 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:19:53.926 +06:00 [INF] Route matched with {action = "Index", controller = "Values"}. Executing controller action with signature System.String Index() on controller HSCFiscalRegistrar.Controllers.ValuesController (HSCFiscalRegistrar).
2019-10-24 15:19:53.932 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:19:53.932 +06:00 [INF] Serialog на старте!
2019-10-24 15:19:53.935 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.5617ms.
2019-10-24 15:19:53.942 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:19:53.956 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) in 28.7821ms
2019-10-24 15:19:53.956 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:19:53.959 +06:00 [INF] Request finished in 92.8616ms 200 text/plain; charset=utf-8
2019-10-24 15:19:58.684 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/Check application/json 1390
2019-10-24 15:19:58.686 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:19:58.700 +06:00 [INF] Route matched with {action = "Post", controller = "Check"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.Fiscalization.KKM.CheckOperationRequest) on controller HSCFiscalRegistrar.Controllers.CheckController (HSCFiscalRegistrar).
2019-10-24 15:19:58.705 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:19:59.726 +06:00 [INF] Executed DbCommand (261ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:19:59.848 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:19:59.850 +06:00 [INF] Check|Post
2019-10-24 15:19:59.850 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-24 15:19:59.850 +06:00 [INF] Информация по чеку: a5a1c23a-b88f-40c5-984a-b267ba521fd6%oe7vj3t8wkeqP8d2ogvg
2019-10-24 15:20:00.211 +06:00 [INF] Executed DbCommand (269ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-24 15:20:00.552 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__checkOperationRequest_CashboxUniqueNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."SerialNumber" = @__checkOperationRequest_CashboxUniqueNumber_0
LIMIT 1
2019-10-24 15:20:00.833 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-24 15:20:00.835 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-24 15:20:00.838 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-24 15:20:01.102 +06:00 [INF] Executed DbCommand (261ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:20:01.376 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:20:01.643 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__kkm_UserId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."Id" = @__kkm_UserId_0
LIMIT 1
2019-10-24 15:20:01.914 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS s
WHERE s."ShiftId" = @__shift_Id_0
2019-10-24 15:20:04.229 +06:00 [INF] Executed DbCommand (268ms) [Parameters=[@p19='?', @p0='?', @p1='?', @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?', @p14='?' (DbType = Int32), @p15='?', @p16='?', @p17='?', @p18='?', @p20='?', @p21='?' (DbType = Decimal), @p22='?' (DbType = Decimal), @p23='?' (DbType = Decimal), @p24='?' (DbType = Decimal), @p25='?' (DbType = Decimal), @p26='?' (DbType = Int32), @p27='?' (DbType = DateTime), @p28='?', @p29='?' (DbType = Boolean), @p30='?', @p31='?' (DbType = Int32), @p32='?', @p33='?', @p34='?' (DbType = Int32), @p35='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "Address" = @p0, "CurrentStatus" = @p1, "Description" = @p2, "DeviceId" = @p3, "FnsKkmId" = @p4, "IdentificationNumber" = @p5, "Iin" = @p6, "LastDateOperation" = @p7, "Mode" = @p8, "Name" = @p9, "NameOrg" = @p10, "OfdToken" = @p11, "OperatorId" = @p12, "PointOfPayment" = @p13, "ReqNum" = @p14, "SerialNumber" = @p15, "TerminalNumber" = @p16, "UserId" = @p17, "UserId1" = @p18
WHERE "Id" = @p19;
INSERT INTO "Operations" ("Id", "Amount", "CardAmount", "CashAmount", "CashAmountFromClient", "ChangeAmount", "CheckNumber", "CreationDate", "FiscalNumber", "IsOffline", "KkmId", "OperationState", "QR", "ShiftId", "Type", "UserId")
VALUES (@p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35);
2019-10-24 15:20:04.507 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4658.6694ms.
2019-10-24 15:20:04.509 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:20:04.510 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) in 5810.4746000000005ms
2019-10-24 15:20:04.511 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:20:04.512 +06:00 [INF] Request finished in 5830.1506ms 200 text/plain; charset=utf-8
2019-10-24 15:21:06.575 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/ZReport application/json 116
2019-10-24 15:21:06.576 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar)'
2019-10-24 15:21:06.577 +06:00 [INF] Route matched with {action = "Post", controller = "ZReport"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.ZReportController (HSCFiscalRegistrar).
2019-10-24 15:21:06.577 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:21:07.595 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:21:07.599 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:21:07.600 +06:00 [INF] ZReport|Post
2019-10-24 15:21:07.600 +06:00 [INF] Z-Отчет: a5a1c23a-b88f-40c5-984a-b267ba521fd6%oe7vj3t8wkeqP8d2ogvg
2019-10-24 15:21:11.469 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-24 15:21:12.892 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-24 15:21:14.672 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-24 15:21:14.933 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE s."KkmId" = @__kkm_Id_0
2019-10-24 15:21:17.381 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:17.644 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:17.905 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:18.167 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:18.430 +06:00 [INF] Executed DbCommand (261ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:18.691 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:18.951 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:19.213 +06:00 [INF] Executed DbCommand (261ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:19.473 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:19.737 +06:00 [INF] Executed DbCommand (264ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:19.998 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:20.257 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:20.517 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:20.777 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:21.037 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:21.299 +06:00 [INF] Executed DbCommand (261ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:21.559 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:21.820 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:22.080 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:22.343 +06:00 [INF] Executed DbCommand (262ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:21:26.194 +06:00 [INF] Executed DbCommand (261ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-24 15:21:26.457 +06:00 [INF] Executed DbCommand (261ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-24 15:21:26.719 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-24 15:21:26.979 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-24 15:21:27.240 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-24 15:21:27.502 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-24 15:21:27.762 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-24 15:21:28.022 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-24 15:21:30.638 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__kkm_UserId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."Id" = @__kkm_UserId_0
LIMIT 1
2019-10-24 15:21:31.571 +06:00 [INF] OfdCloseShiftRequest|Post
2019-10-24 15:21:31.571 +06:00 [INF] Отправка запроса на закрытие смены в ОФД
2019-10-24 15:21:37.981 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-24 15:21:39.873 +06:00 [INF] Executed DbCommand (512ms) [Parameters=[@p2='?', @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?', @p10='?' (DbType = Decimal), @p11='?', @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Decimal), @p15='?' (DbType = Int32), @p16='?' (DbType = Int32), @p17='?', @p18='?' (DbType = Decimal), @p19='?', @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?', @p26='?' (DbType = Decimal), @p27='?', @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Decimal), @p31='?' (DbType = Int32), @p32='?' (DbType = Int32), @p33='?', @p34='?' (DbType = Decimal), @p38='?', @p35='?' (DbType = DateTime), @p36='?' (DbType = Decimal), @p37='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "OfdToken" = @p0, "ReqNum" = @p1
WHERE "Id" = @p2;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34);
UPDATE "Shifts" SET "CloseDate" = @p35, "KkmBalance" = @p36, "SellSaldoEnd" = @p37
WHERE "Id" = @p38;
2019-10-24 15:21:41.730 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 34130.3464ms.
2019-10-24 15:21:41.731 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:21:41.731 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar) in 35153.9665ms
2019-10-24 15:21:41.731 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar)'
2019-10-24 15:21:41.731 +06:00 [INF] Request finished in 35155.8616ms 200 text/plain; charset=utf-8
2019-10-24 15:23:34.451 +06:00 [INF] Starting web host
2019-10-24 15:23:35.665 +06:00 [INF] User profile is available. Using 'C:\Users\Dell\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-10-24 15:23:36.833 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:23:39.579 +06:00 [INF] Executed DbCommand (268ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:23:40.476 +06:00 [INF] Request starting HTTP/1.1 GET http://localhost:6001/api/values  
2019-10-24 15:23:40.482 +06:00 [WRN] Failed to determine the https port for redirect.
2019-10-24 15:23:40.514 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:23:40.526 +06:00 [INF] Route matched with {action = "Index", controller = "Values"}. Executing controller action with signature System.String Index() on controller HSCFiscalRegistrar.Controllers.ValuesController (HSCFiscalRegistrar).
2019-10-24 15:23:40.532 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:23:40.532 +06:00 [INF] Serialog на старте!
2019-10-24 15:23:40.534 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.3745ms.
2019-10-24 15:23:40.541 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:23:40.556 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar) in 27.910600000000002ms
2019-10-24 15:23:40.556 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.ValuesController.Index (HSCFiscalRegistrar)'
2019-10-24 15:23:40.558 +06:00 [INF] Request finished in 82.9202ms 200 text/plain; charset=utf-8
2019-10-24 15:23:41.788 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/Check application/json 1390
2019-10-24 15:23:41.792 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:23:41.804 +06:00 [INF] Route matched with {action = "Post", controller = "Check"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Models.DTO.Fiscalization.KKM.CheckOperationRequest) on controller HSCFiscalRegistrar.Controllers.CheckController (HSCFiscalRegistrar).
2019-10-24 15:23:41.813 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:23:42.888 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:23:43.011 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:23:43.013 +06:00 [INF] Check|Post
2019-10-24 15:23:43.013 +06:00 [INF] Получение списка касс пользователя: Microsoft.AspNetCore.Identity.UserManager`1[Models.User]
2019-10-24 15:23:43.013 +06:00 [INF] Информация по чеку: a5a1c23a-b88f-40c5-984a-b267ba521fd6%oe7vj3t8wkeqP8d2ogvg
2019-10-24 15:23:43.398 +06:00 [INF] Executed DbCommand (268ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."AccessFailedCount", e."Address", e."ConcurrencyStamp", e."DateTimeCreationToken", e."Email", e."EmailConfirmed", e."ExpiryDate", e."Fio", e."Inn", e."KkmId", e."LockoutEnabled", e."LockoutEnd", e."NormalizedEmail", e."NormalizedUserName", e."Okved", e."OperatorCode", e."OwnerId", e."PasswordHash", e."PhoneNumber", e."PhoneNumberConfirmed", e."SecurityStamp", e."TaxationType", e."Title", e."TwoFactorEnabled", e."UserName", e."UserToken", e."UserType", e."VAT", e."VATNumber", e."VATSeria"
FROM "AspNetUsers" AS e
WHERE e."Id" = @__get_Item_0
LIMIT 1
2019-10-24 15:23:43.743 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__checkOperationRequest_CashboxUniqueNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."SerialNumber" = @__checkOperationRequest_CashboxUniqueNumber_0
LIMIT 1
2019-10-24 15:23:44.023 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM "Shifts" AS s)
    THEN TRUE::bool ELSE FALSE::bool
END
2019-10-24 15:23:44.025 +06:00 [WRN] Query: '(from Shift <generated>_1 in DbSet<Shift> select [<generated>_1]).Last()' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-10-24 15:23:44.028 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-24 15:23:44.288 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:23:44.562 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:23:44.821 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:23:45.080 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:23:45.338 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:23:45.597 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:23:45.927 +06:00 [INF] Executed DbCommand (265ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Decimal), @p5='?', @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime), @p8='?' (DbType = Decimal), @p9='?' (DbType = Decimal), @p10='?' (DbType = Decimal), @p11='?' (DbType = Decimal), @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Shifts" ("Id", "BuySaldoBegin", "BuySaldoEnd", "CloseDate", "KkmBalance", "KkmId", "Number", "OpenDate", "RetunBuySaldoBegin", "RetunBuySaldoEnd", "RetunSellSaldoBegin", "RetunSellSaldoEnd", "SellSaldoBegin", "SellSaldoEnd", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2019-10-24 15:23:46.454 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
2019-10-24 15:23:46.720 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__kkm_UserId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."Id" = @__kkm_UserId_0
LIMIT 1
2019-10-24 15:23:46.989 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS s
WHERE s."ShiftId" = @__shift_Id_0
2019-10-24 15:23:49.126 +06:00 [INF] Executed DbCommand (263ms) [Parameters=[@p19='?', @p0='?', @p1='?', @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?', @p14='?' (DbType = Int32), @p15='?', @p16='?', @p17='?', @p18='?', @p20='?', @p21='?' (DbType = Decimal), @p22='?' (DbType = Decimal), @p23='?' (DbType = Decimal), @p24='?' (DbType = Decimal), @p25='?' (DbType = Decimal), @p26='?' (DbType = Int32), @p27='?' (DbType = DateTime), @p28='?', @p29='?' (DbType = Boolean), @p30='?', @p31='?' (DbType = Int32), @p32='?', @p33='?', @p34='?' (DbType = Int32), @p35='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "Address" = @p0, "CurrentStatus" = @p1, "Description" = @p2, "DeviceId" = @p3, "FnsKkmId" = @p4, "IdentificationNumber" = @p5, "Iin" = @p6, "LastDateOperation" = @p7, "Mode" = @p8, "Name" = @p9, "NameOrg" = @p10, "OfdToken" = @p11, "OperatorId" = @p12, "PointOfPayment" = @p13, "ReqNum" = @p14, "SerialNumber" = @p15, "TerminalNumber" = @p16, "UserId" = @p17, "UserId1" = @p18
WHERE "Id" = @p19;
INSERT INTO "Operations" ("Id", "Amount", "CardAmount", "CashAmount", "CashAmountFromClient", "ChangeAmount", "CheckNumber", "CreationDate", "FiscalNumber", "IsOffline", "KkmId", "OperationState", "QR", "ShiftId", "Type", "UserId")
VALUES (@p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35);
2019-10-24 15:23:49.394 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 6382.0157ms.
2019-10-24 15:23:49.396 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:23:49.397 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar) in 7592.868ms
2019-10-24 15:23:49.397 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.CheckController.Post (HSCFiscalRegistrar)'
2019-10-24 15:23:49.399 +06:00 [INF] Request finished in 7611.5106ms 200 text/plain; charset=utf-8
2019-10-24 15:24:06.816 +06:00 [INF] Request starting HTTP/1.1 POST http://localhost:6001/api/ZReport application/json 116
2019-10-24 15:24:06.816 +06:00 [INF] Executing endpoint 'HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar)'
2019-10-24 15:24:06.817 +06:00 [INF] Route matched with {action = "Post", controller = "ZReport"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(Models.DTO.XReport.KkmRequest) on controller HSCFiscalRegistrar.Controllers.ZReportController (HSCFiscalRegistrar).
2019-10-24 15:24:06.818 +06:00 [INF] Entity Framework Core 2.2.6-servicing-10079 initialized 'ApplicationContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL' with options: using lazy-loading proxies 
2019-10-24 15:24:07.851 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

                    SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
                    FROM information_schema.tables
                    WHERE table_type = 'BASE TABLE' AND table_schema NOT IN ('pg_catalog', 'information_schema')
2019-10-24 15:24:07.854 +06:00 [INF] Executing action method HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar) - Validation state: "Valid"
2019-10-24 15:24:07.856 +06:00 [INF] ZReport|Post
2019-10-24 15:24:07.856 +06:00 [INF] Z-Отчет: a5a1c23a-b88f-40c5-984a-b267ba521fd6%oe7vj3t8wkeqP8d2ogvg
2019-10-24 15:24:08.119 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__request_Token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."UserToken" = @__request_Token_0
LIMIT 1
2019-10-24 15:24:08.381 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__user_KkmId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT k."Id", k."Address", k."CurrentStatus", k."Description", k."DeviceId", k."FnsKkmId", k."IdentificationNumber", k."Iin", k."LastDateOperation", k."Mode", k."Name", k."NameOrg", k."OfdToken", k."OperatorId", k."PointOfPayment", k."ReqNum", k."SerialNumber", k."TerminalNumber", k."UserId", k."UserId1"
FROM "Kkms" AS k
WHERE k."Id" = @__user_KkmId_0
LIMIT 1
2019-10-24 15:24:08.384 +06:00 [WRN] The LINQ expression 'Last()' could not be translated and will be evaluated locally.
2019-10-24 15:24:08.643 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__kkm_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BuySaldoBegin", s."BuySaldoEnd", s."CloseDate", s."KkmBalance", s."KkmId", s."Number", s."OpenDate", s."RetunBuySaldoBegin", s."RetunBuySaldoEnd", s."RetunSellSaldoBegin", s."RetunSellSaldoEnd", s."SellSaldoBegin", s."SellSaldoEnd", s."UserId"
FROM "Shifts" AS s
WHERE s."KkmId" = @__kkm_Id_0
2019-10-24 15:24:12.964 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:13.226 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:13.489 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:13.749 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:14.011 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:14.271 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:14.529 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:14.788 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:15.047 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:15.306 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:15.565 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:15.825 +06:00 [INF] Executed DbCommand (260ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:16.085 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:16.343 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:16.602 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:16.861 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CardAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:17.119 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."CashAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:17.378 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:17.637 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:17.896 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?', @__type_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."ChangeAmount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = @__type_1)
2019-10-24 15:24:18.158 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-24 15:24:18.418 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-24 15:24:18.680 +06:00 [INF] Executed DbCommand (259ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-24 15:24:18.938 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-24 15:24:19.198 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 2)
2019-10-24 15:24:19.460 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 1)
2019-10-24 15:24:19.718 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 0)
2019-10-24 15:24:19.977 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT SUM(o."Amount")
FROM "Operations" AS o
WHERE (o."ShiftId" = @__shift_Id_0) AND (o."Type" = 3)
2019-10-24 15:24:20.236 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__kkm_UserId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AccessFailedCount", u."Address", u."ConcurrencyStamp", u."DateTimeCreationToken", u."Email", u."EmailConfirmed", u."ExpiryDate", u."Fio", u."Inn", u."KkmId", u."LockoutEnabled", u."LockoutEnd", u."NormalizedEmail", u."NormalizedUserName", u."Okved", u."OperatorCode", u."OwnerId", u."PasswordHash", u."PhoneNumber", u."PhoneNumberConfirmed", u."SecurityStamp", u."TaxationType", u."Title", u."TwoFactorEnabled", u."UserName", u."UserToken", u."UserType", u."VAT", u."VATNumber", u."VATSeria"
FROM "AspNetUsers" AS u
WHERE u."Id" = @__kkm_UserId_0
LIMIT 1
2019-10-24 15:24:20.238 +06:00 [INF] OfdCloseShiftRequest|Post
2019-10-24 15:24:20.238 +06:00 [INF] Отправка запроса на закрытие смены в ОФД
2019-10-24 15:24:23.455 +06:00 [INF] Executed DbCommand (258ms) [Parameters=[@__shift_Id_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)::INT
FROM "Operations" AS o
WHERE o."ShiftId" = @__shift_Id_0
2019-10-24 15:24:23.488 +06:00 [INF] Executed action method HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 15633.4721ms.
2019-10-24 15:24:23.488 +06:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2019-10-24 15:24:23.488 +06:00 [INF] Executed action HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar) in 16670.7003ms
2019-10-24 15:24:23.488 +06:00 [INF] Executed endpoint 'HSCFiscalRegistrar.Controllers.ZReportController.Post (HSCFiscalRegistrar)'
2019-10-24 15:24:23.927 +06:00 [ERR] Failed executing DbCommand (459ms) [Parameters=[@p2='?', @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Decimal), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?', @p10='?' (DbType = Decimal), @p11='?', @p12='?' (DbType = Decimal), @p13='?' (DbType = Decimal), @p14='?' (DbType = Decimal), @p15='?' (DbType = Int32), @p16='?' (DbType = Int32), @p17='?', @p18='?' (DbType = Decimal), @p19='?', @p20='?' (DbType = Decimal), @p21='?' (DbType = Decimal), @p22='?' (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?', @p26='?' (DbType = Decimal), @p27='?', @p28='?' (DbType = Decimal), @p29='?' (DbType = Decimal), @p30='?' (DbType = Decimal), @p31='?' (DbType = Int32), @p32='?' (DbType = Int32), @p33='?', @p34='?' (DbType = Decimal), @p36='?', @p35='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Kkms" SET "OfdToken" = @p0, "ReqNum" = @p1
WHERE "Id" = @p2;
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26);
INSERT INTO "ShiftOperations" ("Id", "CardAmount", "CashAmount", "Change", "Count", "OperationType", "ShiftId", "TotalAmount")
VALUES (@p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34);
UPDATE "Shifts" SET "CloseDate" = @p35
WHERE "Id" = @p36;
Npgsql.NpgsqlException (0x80004005): Unknown message code: 111
   at Npgsql.PGUtil.ValidateBackendMessageCode(BackendMessageCode code) in C:\projects\npgsql\src\Npgsql\PGUtil.cs:line 84
   at Npgsql.NpgsqlConnector.<>c__DisplayClass161_0.<<ReadMessage>g__ReadMessageLong|0>d.MoveNext() in C:\projects\npgsql\src\Npgsql\NpgsqlConnector.cs:line 957
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Npgsql.NpgsqlConnector.<>c__DisplayClass161_0.<<ReadMessage>g__ReadMessageLong|0>d.MoveNext() in C:\projects\npgsql\src\Npgsql\NpgsqlConnector.cs:line 938
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming) in C:\projects\npgsql\src\Npgsql\NpgsqlDataReader.cs:line 444
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken) in C:\projects\npgsql\src\Npgsql\NpgsqlCommand.cs:line 1215
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
